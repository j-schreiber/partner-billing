<template>

    <lightning-card title={invoiceTitle}>

        <lightning-button-icon
            class="slds-m-horizontal_medium"
            slot="actions"
            icon-name="utility:refresh"
            alternative-text="Refresh Data"
            disabled={readonly}
            onclick={reset}>
        </lightning-button-icon>
        <lightning-button
            label="New Line Item"
            icon-name="utility:add"
            slot="actions"
            class="slds-m-right_large"
            disabled={readonly}
            onclick={addLineItem}>
        </lightning-button>

        <lightning-button-group slot="actions">
            <lightning-button-stateful
                label-when-off="Activate"
                label-when-on="Activated"
                data-id="activateButton"
                icon-name-when-off="utility:check"
                icon-name-when-on="utility:check"
                selected={isActivated}
                variant="success"
                onclick={handleActivateButtonClick}>
            </lightning-button-stateful>
            <lightning-button-stateful
                label-when-off="Cancel"
                label-when-on="Cancelled"
                data-id="cancelButton"
                icon-name-when-off="utility:close"
                icon-name-when-on="utility:close"
                variant="destructive"
                selected={isCancelled}
                onclick={handleCancelButtonClick}>
            </lightning-button-stateful>
        </lightning-button-group>

        <!-- card body -->
        <div class="slds-p-horizontal_medium">
            
            <!-- the invoice body -->
            <div class="slds-m-bottom_large slds-grid slds-grid_vertical">
                <div class="slds-col slds-grid">
                    <lightning-input
                        value={record.Date__c}
                        name="Date__c"
                        type="date"
                        variant="label-inline"
                        label="Invoice Date"
                        disabled={readonly}
                        onchange={handleDataInput}>
                    </lightning-input>
                    <lightning-input
                        value={record.ServicePeriodFrom__c}
                        name="ServicePeriodFrom__c"
                        type="date"
                        label="Service Period Start"
                        variant="label-inline"
                        max={record.ServicePeriodTo__c}
                        disabled={readonly}
                        onchange={handleDataInput}>
                    </lightning-input>
                    <lightning-input 
                        value={record.ServicePeriodTo__c}
                        name="ServicePeriodTo__c"
                        type="date"
                        label="Service Period End"
                        variant="label-inline"
                        min={record.ServicePeriodFrom__c}
                        disabled={readonly}
                        onchange={handleDataInput}>
                    </lightning-input>
                </div>
                <div class="slds-col slds-grid slds-grid_align-end">
                    <div class="slds-size_3-of-12">
                        <table class="summary-table">
                            <tbody>
                                <tr>
                                    <td class="slds-form-element__label">Total Amount (Net)</td>
                                    <td>
                                        <lightning-formatted-number
                                            value={TotalAmount}
                                            format-style="currency"
                                            currency-code={record.CurrencyIsoCode}>
                                        </lightning-formatted-number>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="slds-form-element__label">Total VAT</td>
                                    <td>
                                        <lightning-formatted-number
                                            value={TotalTaxes}
                                            format-style="currency"
                                            currency-code={record.CurrencyIsoCode}>
                                        </lightning-formatted-number>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="slds-form-element__label">Total Amount (Gross)</td>
                                    <td>
                                        <lightning-formatted-number
                                            value={TotalGrossAmount}
                                            format-style="currency"
                                            currency-code={record.CurrencyIsoCode}>
                                        </lightning-formatted-number>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    
                </div>
            </div>
            
            <!-- the line item table -->
            <c-invoice-line-item-datatable
                invoice-id={rowdata.Record.Id}
                line-items={rowdata.LineItems}
                is-disabled={readonly}
                onrecalculate={recalculateSums}>
            </c-invoice-line-item-datatable>

        </div>
        
    </lightning-card>

</template>